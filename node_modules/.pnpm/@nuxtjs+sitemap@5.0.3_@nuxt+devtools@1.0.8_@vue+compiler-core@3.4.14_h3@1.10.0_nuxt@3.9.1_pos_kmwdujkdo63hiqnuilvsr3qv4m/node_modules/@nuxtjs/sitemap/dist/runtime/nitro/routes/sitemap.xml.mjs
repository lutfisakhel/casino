import { defineEventHandler, sendRedirect } from "h3";
import { withBase } from "ufo";
import { useSimpleSitemapRuntimeConfig } from "../utils.mjs";
import { createSitemap } from "../sitemap/nitro.mjs";
import { useRuntimeConfig } from "#imports";
export default defineEventHandler(async (e) => {
  const runtimeConfig = useSimpleSitemapRuntimeConfig();
  const { sitemaps } = runtimeConfig;
  if ("index" in sitemaps) {
    return sendRedirect(e, withBase("/sitemap_index.xml", useRuntimeConfig().app.baseURL), process.dev ? 302 : 301);
  }
  return createSitemap(e, Object.values(sitemaps)[0], runtimeConfig);
});
